<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>View-Once Upload</title>
<style>
body{font-family:Arial,Helvetica,sans-serif;max-width:760px;margin:40px auto;padding:0 16px}
.box{border:1px solid #ddd;padding:16px;border-radius:8px}
input[type=file]{display:block;margin-bottom:12px}
.link{word-break:break-all;background:#f7f7f7;padding:8px;border-radius:6px}
</style>
</head>
<body>
<h1>Simple View-Once Upload (Prototype)</h1>
<div class="box">
<form id="uploadForm">
<input type="file" name="file" id="fileInput" required />
<button type="submit">Upload & Get Link</button>
</form>
<p id="result"></p>
</div>


<script>
const form = document.getElementById('uploadForm');
const result = document.getElementById('result');


form.addEventListener('submit', async (e) => {
e.preventDefault();
const f = document.getElementById('fileInput').files[0];
if (!f) return alert('Choose a file');


const fd = new FormData();
fd.append('file', f);


result.textContent = 'Uploading...';


try {
const r = await fetch('/api/upload', { method: 'POST', body: fd });
const j = await r.json();
if (j.link) {
result.innerHTML = '<strong>Share link (view-once):</strong><div class="link">' + j.link + '</div>';
} else {
result.textContent = 'Upload failed';
}
} catch (err) {
result.textContent = 'Error: ' + err.message;
}
});
</script>
</body>
</html>
